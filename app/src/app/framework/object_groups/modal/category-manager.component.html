<div class="category-manager-backdrop" (click)="closeCategoryManager()">
    <!-- Modal Wrapper -->
    <div class="category-manager-modal" (click)="$event.stopPropagation()">
      <!-- Modal Header -->
      <div class="modal-header">
        <h5 class="modal-title mb-0">Manage Categories</h5>
        <button type="button" class="close" (click)="closeCategoryManager()">
          <span aria-hidden="true">Ã—</span>
        </button>
      </div>
  
      <!-- Modal Body -->
      <div class="modal-body">
        <div class="add-category-inline d-flex align-items-center mb-3">
          <input type="text"
                 class="form-control"
                 [(ngModel)]="newCategoryName"
                 name="newCategoryName"
                 placeholder="New category name..." />
          <button class="btn btn-success ml-2" (click)="onAddNewCategory()">Add</button>
        </div>
  
        <div class="table-responsive category-table-container">
          <table class="table table-sm mb-0">
            <thead>
              <tr>
                <th>Categories</th>
                <th style="width: 90px;">Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let cat of localCategoryOptions">
                <td>
                  <ng-container *ngIf="editingCategoryId === cat.public_id; else readMode">
                    <input type="text"
                           class="form-control form-control-sm"
                           [(ngModel)]="editingCategoryValue" />
                  </ng-container>
                  <ng-template #readMode>
                    {{ cat.value }}
                  </ng-template>
                </td>
                <td>
                  <ng-container *ngIf="editingCategoryId === cat.public_id; else normalActions">
                    <button class="btn btn-link btn-sm text-success p-0 mr-2"
                            (click)="saveEditCategory(cat)">
                      <i class="fas fa-check"></i>
                    </button>
                    <button class="btn btn-link btn-sm text-secondary p-0"
                            (click)="cancelEditCategory()">
                      <i class="fas fa-ban"></i>
                    </button>
                  </ng-container>
                  <ng-template #normalActions>
                    <button class="btn btn-link btn-sm text-primary p-0 mr-2"
                            (click)="onEditCategory(cat)">
                      <i class="far fa-edit"></i>
                    </button>
                    <button class="btn btn-link btn-sm text-danger p-0"
                            (click)="onDeleteCategory(cat)">
                      <i class="far fa-trash-alt"></i>
                    </button>
                  </ng-template>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
  
      <!-- Modal Footer -->
      <div class="modal-footer">
        <button class="btn btn-primary" (click)="closeCategoryManager()">Done</button>
      </div>
    </div>
  </div>
  