<!-- header + add button -->
<div class="d-flex justify-content-between align-items-center mb-3"
     *ngIf="!riskId && !controlMeasureId">
  <h2>Control / Measure Assignments</h2>
  <button class="btn btn-sm btn-success" (click)="onAddNew()">
    <i class="fas fa-plus"></i> Add
  </button>
</div>

<!-- embedded headers -->
<div *ngIf="riskId || controlMeasureId" class="d-flex justify-content-between mb-2">
  <h5 class="mb-0">
    Assignments
    <ng-container *ngIf="riskId">for Risk #{{ riskId }}</ng-container>
    <ng-container *ngIf="controlMeasureId">for Control / Measure #{{ controlMeasureId }}</ng-container>
  </h5>
  <button class="btn btn-sm btn-success" (click)="onAddNew()">
    <i class="fas fa-plus"></i> Add
  </button>
</div>

<hr *ngIf="!hideHeader" />

<!-- cmdb table -->
<cmdb-table
  [items]="assignments"
  [columns]="columns"
  [page]="page"
  [sort]="sort"
  [id]="'control-measure-assignments-table'"
  [emptyMessage]="'No assignments found.'"
  [totalItems]="totalAssignments"
  [selectEnabled]="false"
  [loading]="loading"
  [pageSize]="limit"
  [toggleable]="true"
  [initialVisibleColumns]="initialVisibleColumns"
  (pageChange)="onPageChange($event)"
  (pageSizeChange)="onPageSizeChange($event)"
  (sortChange)="onSortChange($event)"
  (searchChange)="onSearchChange($event)">
</cmdb-table>

<!-- action‑cell template -->
<ng-template #actionTemplate let-item="item">
  <i class="far fa-eye icon-margin cursor-pointer"
     title="View"
     (click)="onView(item)"></i>
</ng-template>
