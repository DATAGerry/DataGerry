<div class="accordion-item">


    <div class="mt-3">

        <!-- Treatment Option (radio) -->
        <!-- <div class="mb-3">
            <label class="form-label">Treatment Option</label>
            <div class="d-flex gap-3">
                <label *ngFor="let opt of riskTreatmentOptions" class="form-check">
                    <input class="form-check-input" type="radio" [value]="opt.value"
                        [formControl]="parentForm.get('risk_treatment_option')" />
                    <span class="form-check-label">{{ opt.label }}</span>
                </label>

                
            </div>
        </div> -->

        <!-- ───── Treatment Option (radios) ───── -->
        <div class="mb-3">
            <label class="d-block">
                Treatment Option<span class="required">*</span>
            </label>

            <!-- every radio shares the SAME control -->
            <ng-container *ngFor="let opt of riskTreatmentOptions">
                <app-radio [label]="opt.label" [value]="opt.value" name="treatmentOptionGroup"
                    [id]="'treatOpt_' + opt.value" [formControl]="parentForm.get('risk_treatment_option')" checked>
                </app-radio>
            </ng-container>
        </div>


        <!-- Responsible Persons Type -->
        <!-- <div class="mb-3">
            <label class="form-label">Responsible Persons Type</label>
            <app-form-select [formControl]="parentForm.get('responsible_persons_id_ref_type')" [items]="personRefTypes"
                bindLabel="label" bindValue="value"></app-form-select>
        </div> -->

        <!-- ───── Responsible Persons Type (radios) ───── -->
        <!-- <div class="mb-3">
            <label class="d-block">
                Responsible Persons Type<span class="required">*</span>
            </label>

            <ng-container *ngFor="let opt of personRefTypes">
                <app-radio [label]="opt.label" [value]="opt.value" name="respPersonsTypeGroup"
                    [id]="'respType_' + opt.value" [formControl]="parentForm.get('responsible_persons_id_ref_type')">
                </app-radio>
            </ng-container>
        </div>



        <div class="mb-3">
            <label>Responsible Persons</label>
            <ng-container [ngSwitch]="parentForm.get('responsible_persons_id_ref_type')?.value">
                <ng-container *ngSwitchCase="'PERSON'">
                    <app-form-select [formControl]="parentForm.get('responsible_persons_id')" [items]="allPersons"
                        bindLabel="display_name" bindValue="public_id"></app-form-select>
                </ng-container>
                <ng-container *ngSwitchCase="'PERSON_GROUP'">
                    <app-form-select [formControl]="parentForm.get('responsible_persons_id')" [items]="allPersonGroups"
                        bindLabel="name" bindValue="public_id"></app-form-select>
                </ng-container>
            </ng-container>
        </div> -->

        <div class="form-block mt-4">
            <label>Responsible Persons<span class="required">*</span></label>

            <app-form-select class="w-100" [items]="responsiblePersonOptions" bindLabel="display_name"
                bindValue="public_id" groupBy="group"  placeholder="Select owner…"
                [formControl]="parentForm.get('responsible_persons_id')" (selectedItemChange)="onOwnerSelected($event)">
            </app-form-select>
        </div>

        <div class="mb-3">
            <label>Risk Treatment Description</label>
            <app-form-textarea [formControl]="parentForm.get('risk_treatment_description')"></app-form-textarea>
        </div>

        <div class="mb-3">
            <label>Planned Implementation Date</label>
            <app-form-date [formControl]="parentForm.get('planned_implementation_date')"></app-form-date>
        </div>

        <div class="mb-3">
            <label>Implementation Status <span class="text-danger">*</span></label>
            <app-form-select [formControl]="parentForm.get('implementation_status')" [items]="implementationStates"
                bindLabel="value" bindValue="public_id" placeholder="Select Implementation Status"></app-form-select>
        </div>

        <div class="mb-3">
            <label>Finished Implementation Date</label>
            <app-form-date [formControl]="parentForm.get('finished_implementation_date')"></app-form-date>
        </div>

        <div class="mb-3">
            <label>Required Resources</label>
            <app-form-textarea [formControl]="parentForm.get('required_resources')"></app-form-textarea>
        </div>

        <div class="row g-3 mb-3">
            <div class="col-md-6">
                <label>Costs for Implementation</label>
                <app-form-input type="boolean"
                    [formControl]="parentForm.get('costs_for_implementation')"></app-form-input>
            </div>
            <div class="col-md-6">
                <label>Currency</label>
                <app-form-input [formControl]="parentForm.get('costs_for_implementation_currency')"></app-form-input>
            </div>
        </div>

        <div class="mb-3">
            <label>Priority</label>
            <app-form-select [formControl]="parentForm.get('priority')" [items]="priorityOptions" bindLabel="label"
                bindValue="value" dropdownDirection="top"
                (selectedItemChange)="onPrioritySelected($event)"></app-form-select>
        </div>

    </div>
</div>