<div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Threats</h2>
    <button class="btn btn-sm btn-success" (click)="onAddNew()">
      <i class="fas fa-plus"></i> Add Threat
    </button>
  </div>
  <hr />
  
  <cmdb-table
    [items]="threats"
    [columns]="columns"
    [page]="page"
    [sort]="sort"
    [id]="'threats-table'"
    [emptyMessage]="'No threats found.'"
    [totalItems]="totalThreats"
    [selectEnabled]="false"
    [loading]="loading"
    [pageSize]="limit"
    [toggleable]="true"
    [initialVisibleColumns]="initialVisibleColumns"
    (pageChange)="onPageChange($event)"
    (pageSizeChange)="onPageSizeChange($event)"
    (sortChange)="onSortChange($event)"
    (searchChange)="onSearchChange($event)"
  >
  </cmdb-table>
  
  <!-- Action Template -->
  <ng-template #actionTemplate let-data="data" let-item="item">
    <i class="far fa-edit icon-margin icon-edit spacing-right"
       (click)="onEdit(item)"
       title="Edit Threat"></i>
    <i class="far fa-trash-alt icon-delete"
       (click)="onDelete(item)"
       title="Delete Threat"></i>
  </ng-template>
  
  <!-- Source Template (to display the source names) -->
  <ng-template #sourceTemplate let-data="data" let-item="item">
    <span>{{ getSourceNames(data) }}</span>
  </ng-template>
  